---
name: "Flake Update Action"
run-name: "nfu"
permissions:
  contents: write
  pull-requests: write
on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 * * 1,4' # Run twice a week

jobs:
  locker:
    runs-on: "ubuntu-latest"
    steps:
      - name: "repo checkout"
        uses: "actions/checkout@v4"
      - name: "nix install"
        uses: "DeterminateSystems/nix-installer-action@v16"
      - name: "flake check"
        uses: "DeterminateSystems/flake-checker-action@v5"
      - name: "flake update"
        uses: "DeterminateSystems/update-flake-lock@v27"
        with:
          token: ${{ secrets.GH_TOKEN_FOR_UPDATES }}"
          git-author-name: "John Nix"
          git-author-email: "github-actions[bot]@users.noreply.github.com"
          git-committer-name: "John Nix"
          git-committer-email: "github-actions[bot]@users.noreply.github.com"
          pr-title: "Update flake.lock Action"
          pr-labels: |
            "CI/CD"
            "automated"
